<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <script type="text/javascript" src="jquery-3.7.1.min.js"></script>
    <script type="text/javascript" src="roslib.min.js"></script>
    <script type="text/javascript" src="js-yaml.min.js"></script>
    <script type="text/javascript" src="FileSaver.js"></script>
    <script type="text/javascript" src="jsoneditor.min.js"></script>
    <script type="text/javascript" src="gui.js" defer></script>

    <link rel="stylesheet" type="text/css" href="./gui.css" />
    <link rel="stylesheet" type="text/css" href="./jsoneditor.min.css" />
  </head>

  <body>
    <h1>Anonymous Autonomous</h1>
    <div id="myModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <span class="closeModal">&times;</span>
        <form
          id="setActiveChairForm"
          class="handwritten_form"
          onsubmit="return handleSetActiveChairs(event);"
        >
          <input type="checkbox" id="activate1" name="1" />
          <label for="activate1">1</label>
          <input type="checkbox" id="activate2" name="2" />
          <label for="activate2">2</label>
          <input type="checkbox" id="activate3" name="3" />
          <label for="activate3">3</label>
          <input type="checkbox" id="activate4" name="4" />
          <label for="activate4">4</label>
          <button type="submit" class="submit_button">Save</button>
        </form>
      </div>
    </div>
    <audio
      id="audio_lowbatt"
      src="audio/582986__oysterqueen__low-battery.mp3"
    ></audio>
    <audio id="audio_beep" src="audio/258193__kodack__beep-beep.wav"></audio>
    <p>Connection status: <span id="status">NOT CONNECTED</span></p>
    <p>Last chair status received: <span id="msg"></span></p>
    <p>
      <span id="num_chairs">0 chairs</span> active:
      <span id="active_chair_list"></span>
      <button id="editActiveChairsBtn">Edit</button>
    </p>
    <div class="screen" id="live" style="display: none">
      <button onclick="stop('0')" class="stop">STOP ALL</button>
      <button onclick="toggle('0')" class="auto">AUTO ALL</button>
      <button class="test_broadcast" onclick="send_test_broadcast()">
        TEST BROADCAST
      </button>
      <button class="clear_broadcast" onclick="send_clear_broadcast()">
        CLEAR BROADCAST
      </button>
      <button class="shutdown_chairs" onclick="send_shutdown_all_chairs()">
        ðŸŒ™ SHUTDOWN ALL
      </button>
      <button class="reset_chair" onclick="send_reset_all_chairs()">
        ðŸ”„ RESET ALL
      </button>
      <div class="statuses" id="chairStatuses">
        <!--
        <div class="chair_monitor" id="1">
          <h2>Chair 1</h2>
          <div class="status o" id="1status">
            OFFLINE<span class="dot"></span>
          </div>
          <div class="status o" id="1_broadcast_status">OFFLINE</div>
          <div class="status o" id="1_stuck_status">OFFLINE</div>
          <div class="status o" id="1_trapped_status">OFFLINE</div>
          <div id="1_flags"></div>
          <br />
          <div class="chair_control">
            <div class="directions">
              <button class="auto" id="1" onclick="toggle(this.id)">
                AUTO
              </button>
              <br />
              <button id="1" onclick="ffwd(this.id)">â¤Š</button>
              <div>
                <button id="1" onclick="fwdl(this.id)">â¬‰</button>
                <button id="1" onclick="fwd(this.id)">â†‘</button>
                <button id="1" onclick="fwdr(this.id)">â¬ˆ</button>
              </div>
              <div>
                <button id="1" onclick="pivotl(this.id)">âŸ²</button>
                <button id="1" onclick="stop(this.id)">ðŸ›‘</button>
                <button id="1" onclick="pivotr(this.id)">âŸ³</button>
              </div>
              <div>
                <button id="1" onclick="bwdl(this.id)">â¬‹</button>
                <button id="1" onclick="bwd(this.id)">â†“</button>
                <button id="1" onclick="bwdr(this.id)">â¬Š</button>
              </div>
              <button id="1" onclick="fbwd(this.id)">â¤‹</button>
            </div>
            <br />
-->
        <!-- <button id="1" onclick="start(this.id)">START</button>
        <button id="1" onclick="stop(this.id)" class="stop">STOP</button> -->
        <!-- 
           <br />
            <form
              id="1custom_handwritten"
              class="handwritten_form"
              onsubmit="return submitForm(event);"
            >
              <label for="custom_handwritten">Custom: </label>
              <input
                type="text"
                id="custom_handwritten"
                name="custom_handwritten"
                size="10"
              />
              <button type="submit" class="submit_button">Send</button>
            </form>
          </div>
        </div>
-->
        <div class="chair_monitor" id="2">
          <h2>Chair 2</h2>
          <div class="status o" id="2status">
            OFFLINE<span class="dot"></span>
          </div>
          <div class="status o" id="2_broadcast_status">OFFLINE</div>
          <div class="status o" id="2_stuck_status">OFFLINE</div>
          <div class="status o" id="2_trapped_status">OFFLINE</div>
          <div id="2_flags"></div>
          <br />
          <div class="chair_control">
            <div class="directions">
              <button class="auto" id="2" onclick="toggle(this.id)">
                AUTO
              </button>
              <br />
              <button id="2" onclick="ffwd(this.id)">â¤Š</button>
              <div>
                <button id="2" onclick="fwdl(this.id)">â¬‰</button>
                <button id="2" onclick="fwd(this.id)">â†‘</button>
                <button id="2" onclick="fwdr(this.id)">â¬ˆ</button>
              </div>
              <div>
                <button id="2" onclick="pivotl(this.id)">âŸ²</button>
                <button id="2" onclick="stop(this.id)">ðŸ›‘</button>
                <button id="2" onclick="pivotr(this.id)">âŸ³</button>
              </div>
              <div>
                <button id="2" onclick="bwdl(this.id)">â¬‹</button>
                <button id="2" onclick="bwd(this.id)">â†“</button>
                <button id="2" onclick="bwdr(this.id)">â¬Š</button>
              </div>
              <button id="2" onclick="fbwd(this.id)">â¤‹</button>
            </div>
            <br />
            <!-- <button id="2" onclick="start(this.id)">START</button>
        <button id="2" onclick="stop(this.id)" class="stop">STOP</button> -->
            <br />
            <form
              id="2custom_handwritten"
              class="handwritten_form"
              onsubmit="return submitForm(event);"
            >
              <label for="custom_handwritten">Custom: </label>
              <input
                type="text"
                id="custom_handwritten"
                name="custom_handwritten"
                size="10"
              />
              <button type="submit" class="submit_button">Send</button>
            </form>
          </div>
        </div>
        <div class="chair_monitor" id="3">
          <h2>Chair 3</h2>
          <div class="status o" id="3status">
            OFFLINE<span class="dot"></span>
          </div>
          <div class="status o" id="3_broadcast_status">OFFLINE</div>
          <div class="status o" id="3_stuck_status">OFFLINE</div>
          <div class="status o" id="3_trapped_status">OFFLINE</div>
          <div id="3_flags"></div>
          <br />
          <div class="chair_control">
            <div class="directions">
              <button class="auto" id="3" onclick="toggle(this.id)">
                AUTO
              </button>
              <br />
              <button id="3" onclick="ffwd(this.id)">â¤Š</button>
              <div>
                <button id="3" onclick="fwdl(this.id)">â¬‰</button>
                <button id="3" onclick="fwd(this.id)">â†‘</button>
                <button id="3" onclick="fwdr(this.id)">â¬ˆ</button>
              </div>
              <div>
                <button id="3" onclick="pivotl(this.id)">âŸ²</button>
                <button id="3" onclick="stop(this.id)">ðŸ›‘</button>
                <button id="3" onclick="pivotr(this.id)">âŸ³</button>
              </div>
              <div>
                <button id="3" onclick="bwdl(this.id)">â¬‹</button>
                <button id="3" onclick="bwd(this.id)">â†“</button>
                <button id="3" onclick="bwdr(this.id)">â¬Š</button>
              </div>
              <button id="3" onclick="fbwd(this.id)">â¤‹</button>
            </div>
            <br />
            <!-- <button id="3" onclick="start(this.id)">START</button>
        <button id="3" onclick="stop(this.id)" class="stop">STOP</button> -->
            <br />
            <form
              id="3custom_handwritten"
              class="handwritten_form"
              onsubmit="return submitForm(event);"
            >
              <label for="custom_handwritten">Custom: </label>
              <input
                type="text"
                id="custom_handwritten"
                name="custom_handwritten"
                size="10"
              />
              <button type="submit" class="submit_button">Send</button>
            </form>
          </div>
        </div>
        <div class="chair_monitor" id="4">
          <h2>Chair 4</h2>
          <div class="status o" id="4status">
            OFFLINE<span class="dot"></span>
          </div>
          <div class="status o" id="4_broadcast_status">OFFLINE</div>
          <div class="status o" id="4_stuck_status">OFFLINE</div>
          <div class="status o" id="4_trapped_status">OFFLINE</div>
          <div id="4_flags"></div>
          <br />
          <div class="chair_control">
            <div class="directions">
              <button class="auto" id="4" onclick="toggle(this.id)">
                AUTO
              </button>
              <br />
              <button id="4" onclick="ffwd(this.id)">â¤Š</button>
              <div>
                <button id="4" onclick="fwdl(this.id)">â¬‰</button>
                <button id="4" onclick="fwd(this.id)">â†‘</button>
                <button id="4" onclick="fwdr(this.id)">â¬ˆ</button>
              </div>
              <div>
                <button id="4" onclick="pivotl(this.id)">âŸ²</button>
                <button id="4" onclick="stop(this.id)">ðŸ›‘</button>
                <button id="4" onclick="pivotr(this.id)">âŸ³</button>
              </div>
              <div>
                <button id="4" onclick="bwdl(this.id)">â¬‹</button>
                <button id="4" onclick="bwd(this.id)">â†“</button>
                <button id="4" onclick="bwdr(this.id)">â¬Š</button>
              </div>
              <button id="4" onclick="fbwd(this.id)">â¤‹</button>
            </div>
            <br />
            <!-- <button id="4" onclick="start(this.id)">START</button>
        <button id="4" onclick="stop(this.id)" class="stop">STOP</button> -->
            <br />
            <form
              id="4custom_handwritten"
              class="handwritten_form"
              onsubmit="return submitForm(event);"
            >
              <label for="custom_handwritten">Custom: </label>
              <input
                type="text"
                id="custom_handwritten"
                name="custom_handwritten"
                size="10"
              />
              <button type="submit" class="submit_button">Send</button>
            </form>
          </div>
        </div>
        <!-- <div class="chair_monitor backup" id="backup">
      <h2>Chair 4 (backup)</h2>
      <div class="status offline">
        OFFLINE
      </div>
    </div> -->
      </div>
      <button
        onclick="switchscreen('config')"
        class="switchscreen"
        id="toConfigScreen"
      >
        switch to configuration mode
      </button>
    </div>
    <div class="screen" id="config">
      <!-- style="display:none"> -->
      <div id="cameraConfig">
        <h3>Camera</h3>
        <form id="cameraSliders">
          <div>
            <label>Brightness</label>
            <input
              type="range"
              min="0"
              max="255"
              value="125"
              class="slider"
              id="brightnessSlider"
              oninput="return setBrightnessThreshold(this.value);"
            />
            <output id="brightnessLabel">125</output>
          </div>
          <div>
            <label>Side Width</label>
            <input
              type="range"
              min="0"
              max="255"
              value="180"
              class="slider"
              id="sideWidthSlider"
              oninput="return setSideWidth(this.value);"
            />
            <output id="sideWidthLabel">180</output>
          </div>
          <div>
            <label>Top Width</label>
            <input
              type="range"
              min="0"
              max="255"
              value="120"
              class="slider"
              id="topWidthSlider"
              oninput="return setTopWidth(this.value);"
            />
            <output id="topWidthLabel">120</output>
          </div>
          <div>
            <label>Side Percentage</label>
            <input
              type="range"
              min="0"
              max="100"
              value="20"
              class="slider"
              id="sidePercentSlider"
              oninput="return setSidePercent(this.value / 100.0);"
            />
            <output id="sidePercentLabel">0.2</output>
          </div>
          <div>
            <label>Top Percentage</label>
            <input
              type="range"
              min="0"
              max="100"
              value="20"
              class="slider"
              id="topPercentSlider"
              oninput="return setTopPercent(this.value / 100.0);"
            />
            <output id="topPercentLabel">0.2</output>
          </div>
        </form>
        <button id="sendCameraConfig" onclick="return sendCameraConfig(event);">
          Send Camera Config
        </button>
        <div class="wrapper">
          <canvas id="bottomCanvas"></canvas>
          <canvas id="canvas"></canvas>
        </div>
      </div>
      <div>
        <form id="openYaml" onsubmit="return openYaml(event);">
          <label for="configFile">Select config file:</label>
          <input type="file" id="configFile" name="configFile" accept=".yaml" />
          <button type="submit">Open</button>
        </form>
      </div>
      <div id="ymlContainer"></div>
      <form id="saveYamlForm" onsubmit="return saveYaml(event);">
        <textarea id="ymlTextArea"></textarea>
        <button type="submit">Save</button>
      </form>
      <button id="sendYaml" onclick="return sendYaml();">Send</button>

      <button
        onclick="switchscreen('live')"
        class="switchscreen"
        id="toLiveScreen"
      >
        switch to live mode
      </button>
    </div>
    <div class="sidebyside">
      <div id="jsoneditor" style="width: 400px; height: 400px"></div>
      <div id="cmd_config_form">
        <form
          class="sidebyside"
          onsubmit="return saveCmd(event, this.submitted);"
        >
          <div>
            <div>
              <input
                type="radio"
                id="html"
                name="left_fwd_back"
                value="left_f"
                checked="checked"
              />
              <label for="left_f">â†‘</label>
            </div>
            <div>
              <input
                type="radio"
                id="css"
                name="left_fwd_back"
                value="left_r"
              />
              <label for="left_r">â†“</label>
            </div>
          </div>
          <div>
            <label for="left_speed">Left Speed</label>
            <input
              type="number"
              id="left_speed"
              name="left_speed"
              min="0.0"
              max="5.0"
              step="0.1"
              value="1.5"
            />
            <p class="explanation">(0 to 5.0)</p>
          </div>
          <div>
            <div>
              <input
                type="radio"
                id="html"
                name="right_fwd_back"
                value="right_f"
                checked="checked"
              />
              <label for="right_f">â†‘</label>
            </div>
            <div>
              <input
                type="radio"
                id="css"
                name="right_fwd_back"
                value="right_r"
              />
              <label for="right_r">â†“</label>
            </div>
          </div>
          <div>
            <label for="right_speed">Right Speed</label>
            <input
              type="number"
              id="right_speed"
              name="right_speed"
              min="0.0"
              max="5.0"
              step="0.1"
              value="1.5"
            />
            <p class="explanation">(0 to 5.0)</p>
          </div>
          <div id="testCmdOnChair">
            <select name="testChair" id="testChairSelect">
              <option value="0">ALL</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
            </select>
            <input
              type="submit"
              name="button"
              value="Test"
              onclick="this.form.submitted=this.value;"
            />
          </div>

          <div id="saveCmdToConfig" class="sidebyside">
            <div class="column">
              <label for="cmd">Select a command</label>
              <input type="text" name="cmd" id="cmd" list="cmds" />
              <datalist id="cmds"></datalist><br />
            </div>
            <input
              type="submit"
              name="button"
              value="Save"
              onclick="this.form.submitted=this.value;"
            />
          </div>
        </form>
      </div>
    </div>
  </body>
</html>
