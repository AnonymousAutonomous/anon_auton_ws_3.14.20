<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <script type="text/javascript" src="jquery-3.7.1.min.js"></script>
    <script type="text/javascript" src="roslib.min.js"></script>
    <script type="text/javascript" src="js-yaml.min.js"></script>
    <script type="text/javascript" src="FileSaver.js"></script>
    <script type="text/javascript" src="jsoneditor.min.js"></script>
    <script type="text/javascript" src="gui.js" defer></script>

    <link rel="stylesheet" type="text/css" href="./gui.css" />
    <link rel="stylesheet" type="text/css" href="./jsoneditor.min.css" />
  </head>

  <body>
    <div class="fullscreen">
    <h1>Anonymous Autonomous</h1>
    <div class="floating_top_right">
      <span id="battery_countdown"></span>
    </div>
    <div id="myModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <span class="closeModal">&times;</span>
        <form
          id="setActiveChairForm"
          class="handwritten_form"
          onsubmit="return handleSetActiveChairs(event);"
        >
          <input type="checkbox" id="activate1" name="1" />
          <label for="activate1">1</label>
          <input type="checkbox" id="activate2" name="2" />
          <label for="activate2">2</label>
          <input type="checkbox" id="activate3" name="3" />
          <label for="activate3">3</label>
          <input type="checkbox" id="activate4" name="4" />
          <label for="activate4">4</label>
          <button type="submit" class="submit_button">Save</button>
        </form>
      </div>
    </div>
    <div id="batteryModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <h3>Please switch batteries!</h3>
        <button onclick="closeBatteryModal()" class="green">Done</button>
      </div>
    </div>
    <div id="connectionModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <h3>Hub is starting up<span class="loading"></span></h3>
        <p>Refresh the page</p>
      </div>
    </div>
    <audio id="audio_beep" src="audio/258193__kodack__beep-beep.wav"></audio>
    <p class="debug">Connection status: <span id="status">NOT CONNECTED</span></p>
    <p class="debug">Last chair status received: <span id="msg"></span></p>
    <p id="active_chairs_p">
      <span id="num_chairs">0 chairs</span> active:
      <span id="active_chair_list"></span>
      <button id="editActiveChairsBtn" class="white">Edit</button>
    </p>
    <div class="screen" id="live" style="display: none">
      <div id="top_buttons">
      <button onclick="stop('0')" class="stop">ALL STOP</button>
      <button onclick="toggle('0')" class="auto">ALL GO</button>
      <button class="test_broadcast debug" onclick="send_test_broadcast()">
        TEST BROADCAST
      </button>
      <button class="clear_broadcast debug" onclick="send_clear_broadcast()">
        CLEAR BROADCAST
      </button>
      <button class="shutdown_chairs white" onclick="send_shutdown_all_chairs()">
        ðŸŒ™ SHUTDOWN ALL
      </button>
      <button class="reset_chair white" onclick="send_reset_all_chairs()">
        ðŸ”„ RESTART ALL
      </button>
      <div class="statuses" id="chairStatuses">
        <!-- Set from gui.js -->
      </div>
      <button
        onclick="switchscreen('config')"
        class="switchscreen debug"
        id="toConfigScreen"
      >
        switch to configuration mode
      </button>
    </div>
    <div class="screen debug" id="config">
      <!-- style="display:none"> -->
      <div id="cameraConfig">
        <h3>Camera</h3>
        <form id="cameraSliders">
          <div>
            <label>Brightness</label>
            <input
              type="range"
              min="0"
              max="255"
              value="125"
              class="slider"
              id="brightnessSlider"
              oninput="return setBrightnessThreshold(this.value);"
            />
            <output id="brightnessLabel">125</output>
          </div>
          <div>
            <label>Side Width</label>
            <input
              type="range"
              min="0"
              max="255"
              value="180"
              class="slider"
              id="sideWidthSlider"
              oninput="return setSideWidth(this.value);"
            />
            <output id="sideWidthLabel">180</output>
          </div>
          <div>
            <label>Top Width</label>
            <input
              type="range"
              min="0"
              max="255"
              value="120"
              class="slider"
              id="topWidthSlider"
              oninput="return setTopWidth(this.value);"
            />
            <output id="topWidthLabel">120</output>
          </div>
          <div>
            <label>Side Percentage</label>
            <input
              type="range"
              min="0"
              max="100"
              value="20"
              class="slider"
              id="sidePercentSlider"
              oninput="return setSidePercent(this.value / 100.0);"
            />
            <output id="sidePercentLabel">0.2</output>
          </div>
          <div>
            <label>Top Percentage</label>
            <input
              type="range"
              min="0"
              max="100"
              value="20"
              class="slider"
              id="topPercentSlider"
              oninput="return setTopPercent(this.value / 100.0);"
            />
            <output id="topPercentLabel">0.2</output>
          </div>
        </form>
        <button id="sendCameraConfig" onclick="return sendCameraConfig(event);">
          Send Camera Config
        </button>
        <div class="wrapper">
          <canvas id="bottomCanvas"></canvas>
          <canvas id="canvas"></canvas>
        </div>
      </div>
      <div>
        <form id="openYaml" onsubmit="return openYaml(event);">
          <label for="configFile">Select config file:</label>
          <input type="file" id="configFile" name="configFile" accept=".yaml" />
          <button type="submit">Open</button>
        </form>
      </div>
      <div id="ymlContainer"></div>
      <form id="saveYamlForm" onsubmit="return saveYaml(event);">
        <textarea id="ymlTextArea"></textarea>
        <button type="submit">Save</button>
      </form>
      <button id="sendYaml" onclick="return sendYaml();">Send</button>

      <button
        onclick="switchscreen('live')"
        class="switchscreen"
        id="toLiveScreen"
      >
        switch to live mode
      </button>
    </div>
    <div class="sidebyside debug">
      <div
        id="jsoneditor"
        class="debug"
        style="width: 400px; height: 400px"
      ></div>
      <div id="cmd_config_form" class="debug">
        <form
          class="sidebyside debug"
          onsubmit="return saveCmd(event, this.submitted);"
        >
          <div class="debug">
            <div>
              <input
                type="radio"
                id="html"
                name="left_fwd_back"
                value="left_f"
                checked="checked"
              />
              <label for="left_f">â†‘</label>
            </div>
            <div>
              <input
                type="radio"
                id="css"
                name="left_fwd_back"
                value="left_r"
              />
              <label for="left_r">â†“</label>
            </div>
          </div>
          <div>
            <label for="left_speed">Left Speed</label>
            <input
              type="number"
              id="left_speed"
              name="left_speed"
              min="0.0"
              max="5.0"
              step="0.1"
              value="1.5"
            />
            <p class="explanation">(0 to 5.0)</p>
          </div>
          <div>
            <div>
              <input
                type="radio"
                id="html"
                name="right_fwd_back"
                value="right_f"
                checked="checked"
              />
              <label for="right_f">â†‘</label>
            </div>
            <div>
              <input
                type="radio"
                id="css"
                name="right_fwd_back"
                value="right_r"
              />
              <label for="right_r">â†“</label>
            </div>
          </div>
          <div>
            <label for="right_speed">Right Speed</label>
            <input
              type="number"
              id="right_speed"
              name="right_speed"
              min="0.0"
              max="5.0"
              step="0.1"
              value="1.5"
            />
            <p class="explanation">(0 to 5.0)</p>
          </div>
          <div id="testCmdOnChair">
            <select name="testChair" id="testChairSelect">
              <option value="0">ALL</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
            </select>
            <input
              type="submit"
              name="button"
              value="Test"
              onclick="this.form.submitted=this.value;"
            />
          </div>

          <div id="saveCmdToConfig" class="sidebyside">
            <div class="column">
              <label for="cmd">Select a command</label>
              <input type="text" name="cmd" id="cmd" list="cmds" />
              <datalist id="cmds"></datalist><br />
            </div>
            <input
              type="submit"
              name="button"
              value="Save"
              onclick="this.form.submitted=this.value;"
            />
          </div>
        </form>
      </div>
    </div>
  </div>
  </body>
</html>
